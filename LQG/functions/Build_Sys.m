A = zeros(40); B = zeros(40,4); C = zeros(8,40); D = 0;

% Defining u1
B(1,1) = (15/1000)*(kp2+ti2/2);
A(1,34) = (-15/1000)*(kp2+ti2/2);
A(1,5) = (15/1000)*(ti2/2);
A(1,9) = 15/1000;

% Defining u2
B(2,2) = (15/1000)*(kp2+ti2/2);
A(2,36) = (-15/1000)*(kp2+ti2/2);
A(2,6) = (15/1000)*(ti2/2);
A(2,10) = 15/1000;

% Defining u3
B(3,3) = (15/1000)*(kp2+ti2/2);
A(3,38) = (-15/1000)*(kp2+ti2/2);
A(3,7) = (15/1000)*(ti2/2);
A(3,11) = 15/1000;

% Defining u4
B(4,4) = (15/1000)*(kp2+ti2/2);
A(4,40) = (-15/1000)*(kp2+ti2/2);
A(4,8) = (15/1000)*(ti2/2);
A(4,12) = 15/1000;

% Defining ep1
B(5,1) = 1;
A(5,34) = -1;

% Defining ep2
B(6,2) = 1;
A(6,36) = -1;

% Defining ep3
B(7,3) = 1;
A(7,38) = -1;

% Defining ep4
B(8,4) = 1;
A(8,40) = -1;

% Defining ei1
B(9,1) = ti2/2;
A(9,34) = -ti2/2;
A(9,5) = ti2/2;
A(9,9) = 1;

% Defining ei2
B(10,2) = ti2/2;
A(10,36) = -ti2/2;
A(10,6) = ti2/2;
A(10,10) = 1;

% Defining ei3
B(11,3) = ti2/2;
A(11,38) = -ti2/2;
A(11,7) = ti2/2;
A(11,11) = 1;

% Defining ei4
B(12,4) = ti2/2;
A(12,40) = -ti2/2;
A(12,8) = ti2/2;
A(12,12) = 1;

% FESS System dynamics
A(13:24,13:24) = Ad;
A(13:24,1:4) = Bd;

% Filter x1
A(25:26,13:24) = [Bf(1)*Cd(1,:);Bf(2)*Cd(1,:)];
A(25:26,25:26) = Af;
C(1,26) = 1;

% Filter y1
A(27:28,13:24) = [Bf(1)*Cd(2,:);Bf(2)*Cd(2,:)];
A(27:28,27:28) = Af;
C(2,28) = 1;

% Filter x2
A(29:30,13:24) = [Bf(1)*Cd(3,:);Bf(2)*Cd(3,:)];
A(29:30,29:30) = Af;
C(3,30) = 1;

% Filter y2
A(31:32,13:24) = [Bf(1)*Cd(4,:);Bf(2)*Cd(4,:)];
A(31:32,31:32) = Af;
C(4,32) = 1;

% Filter i1
A(33:34,13:24) = [Bf(1)*Cd(5,:);Bf(2)*Cd(5,:)];
A(33:34,33:34) = Af;
C(5,34) = 1;

% Filter i2
A(35:36,13:24) = [Bf(1)*Cd(6,:);Bf(2)*Cd(6,:)];
A(35:36,35:36) = Af;
C(6,36) = 1;

% Filter i3
A(37:38,13:24) = [Bf(1)*Cd(7,:);Bf(2)*Cd(7,:)];
A(37:38,37:38) = Af;
C(7,38) = 1;

% Filter i4
A(39:40,13:24) = [Bf(1)*Cd(8,:);Bf(2)*Cd(8,:)];
A(39:40,39:40) = Af;
C(8,40) = 1;